# Cypress 项目使用与自动化测试说明

---

## 一、GitHub Actions 自动化测试

1. **手动运行 GitHub Actions**
   - 登录你的 GitHub 仓库页面。
   - 点击顶部菜单栏的 **Actions**。
   - 在左侧找到 `Cypress E2E Tests` 工作流。
   - 点击 **Run workflow** 按钮，选择分支后手动触发。

2. **工作流执行流程**
   - 自动拉取代码、安装 Node.js 和依赖。
   - 自动安装 Docker Compose 并启动测试环境。
   - 自动运行所有 Cypress E2E 测试。
   - 自动合并并生成测试报告。
   - 自动上传完整报告文件夹（`cypress/reports`）为 artifact。

3. **获取测试报告**
   - 工作流运行结束后，进入该 workflow 的详情页面。
   - 在页面底部找到 **Artifacts** 区域。
   - 下载名为 `cypress-reports` 的压缩包。
   - 解压后可获得所有测试报告，包括：
     - `merged.html`：完整的可视化测试报告，可直接用浏览器打开。
     - `merged.json`：所有测试结果的合并 JSON 文件。
     - `mochawesome` 文件夹：原始分报告。
     - `assets` 文件夹：报告所需静态资源。

4. **注意事项**
   - 若测试环境或依赖安装失败，请检查 workflow 日志，确认 Docker、Node.js、npm 是否正常。
   - 报告文件仅在 workflow 运行结束后生成并上传。
   - 如需自定义测试或报告内容，请修改项目内相关配置文件。

5. **参考**
   - [Cypress 官方文档](https://docs.cypress.io/)
   - [Mochawesome 官方文档](https://github.com/mochawesome/mochawesome)
   - [GitHub Actions 文档](https://docs.github.com/en/actions)

---

## 二、项目本地环境与测试

1. **环境准备**
   - 安装 Node.js（推荐 18.8 及以上版本,本地测试版本为24）。
   - 安装 Docker 和 docker-compose。
   - 在项目根目录下执行 `npm install` 安装依赖。

2. **启动/重置测试环境（Docker）**
   - 启动：进入 cypress/docker 目录，执行 `docker-compose up -d`。
   - 重置：
     - Windows：运行 `restart-docker.bat`
     - Linux/Mac：运行 `restart-docker.sh`

3. **运行本地测试**
   - 执行所有 E2E 测试：
     ```bash
     npx cypress run --spec "cypress/e2e/**/*.cy.ts"
     ```
   - 交互调试模式：
     ```bash
     npx cypress open
     ```
   - 测试结果会在命令行输出，并可在 `cypress/reports` 目录下查看详细报告。

4. **其它说明**
   - 如有疑问，请联系项目维护者或查阅本项目 README.md。
